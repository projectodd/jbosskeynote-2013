/*! AeroGear JavaScript Library - v1.0.0-M3 - 2013-03-08
* https://github.com/aerogear/aerogear-js
* JBoss, Home of Professional Open Source
* Copyright Red Hat, Inc., and individual contributors
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
* http://www.apache.org/licenses/LICENSE-2.0
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
var AeroGear={};AeroGear.Core=function(){if(this instanceof AeroGear.Core)throw"Invalid instantiation of base class AeroGear.Core";this.add=function(e){var t,r,n=this[this.collectionName]||{};if(!e)return this;if("string"==typeof e)n[e]=AeroGear[this.lib].adapters[this.type](e);else if(AeroGear.isArray(e))for(t=0;e.length>t;t++)r=e[t],"string"==typeof r?n[r]=AeroGear[this.lib].adapters[this.type](r):n[r.name]=AeroGear[this.lib].adapters[r.type||this.type](r.name,r.settings||{});else n[e.name]=AeroGear[this.lib].adapters[e.type||this.type](e.name,e.settings||{});return this[this.collectionName]=n,this},this.remove=function(e){var t,r,n=this[this.collectionName]||{};if("string"==typeof e)delete n[e];else if(AeroGear.isArray(e))for(t=0;e.length>t;t++)r=e[t],"string"==typeof r?delete n[r]:delete n[r.name];else e&&delete n[e.name];return this[this.collectionName]=n,this}},AeroGear.isArray=function(e){return"[object Array]"==={}.toString.call(e)},function(){function e(e,t,r){var n=t&&r||0,a=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>a&&(t[n+a++]=l[e])});16>a;)t[n+a++]=0;return t}function t(e,t){var r=t||0,n=g;return n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+"-"+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]+n[e[r++]]}function r(e,r,n){var a=r&&n||0,i=r||[];e=e||{};var s=null!=e.clockseq?e.clockseq:N,o=null!=e.msecs?e.msecs:(new Date).getTime(),u=null!=e.nsecs?e.nsecs:C+1,c=o-A+(u-C)/1e4;if(0>c&&null==e.clockseq&&(s=16383&s+1),(0>c||o>A)&&null==e.nsecs&&(u=0),u>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");A=o,C=u,N=s,o+=122192928e5;var p=(1e4*(268435455&o)+u)%4294967296;i[a++]=255&p>>>24,i[a++]=255&p>>>16,i[a++]=255&p>>>8,i[a++]=255&p;var f=268435455&1e4*(o/4294967296);i[a++]=255&f>>>8,i[a++]=255&f,i[a++]=16|15&f>>>24,i[a++]=255&f>>>16,i[a++]=128|s>>>8,i[a++]=255&s;for(var h=e.node||v,d=0;6>d;d++)i[a+d]=h[d];return r?r:t(i)}function n(e,r,n){var a=r&&n||0;"string"==typeof e&&(r="binary"==e?new d(16):null,e=null),e=e||{};var i=e.random||(e.rng||h)();if(i[6]=64|15&i[6],i[8]=128|63&i[8],r)for(var s=0;16>s;s++)r[a+s]=i[s];return r||t(i)}var a,i,s,o=this,u=Array(16);if(a=function(){for(var e,e,t=u,r=0,r=0;16>r;r++)0==(3&r)&&(e=4294967296*Math.random()),t[r]=255&e>>>((3&r)<<3);return t},o.crypto&&crypto.getRandomValues){var c=new Uint32Array(4);s=function(){crypto.getRandomValues(c);for(var e=0;16>e;e++)u[e]=255&c[e>>2]>>>8*(3&e);return u}}try{var p=require("crypto").randomBytes;i=p&&function(){return p(16)}}catch(f){}for(var h=i||s||a,d="function"==typeof Buffer?Buffer:Array,g=[],l={},y=0;256>y;y++)g[y]=(y+256).toString(16).substr(1),l[g[y]]=y;var m=h(),v=[1|m[0],m[1],m[2],m[3],m[4],m[5]],N=16383&(m[6]<<8|m[7]),A=0,C=0,S=n;if(S.v1=r,S.v4=n,S.parse=e,S.unparse=t,S.BufferClass=d,S.mathRNG=a,S.nodeRNG=i,S.whatwgRNG=s,"undefined"!=typeof module)module.exports=S;else{var D=o.uuid;S.noConflict=function(){return o.uuid=D,S},o.uuid=S}}(),function(e){e.Pipeline=function(t){return this instanceof e.Pipeline?(e.Core.call(this),this.lib="Pipeline",this.type=t?t.type||"Rest":"Rest",this.collectionName="pipes",this.add(t),undefined):new e.Pipeline(t)},e.Pipeline.prototype=e.Core,e.Pipeline.constructor=e.Pipeline,e.Pipeline.adapters={}}(AeroGear,jQuery),function(e,t,r,n){e.Pipeline.adapters.Rest=function(r,a){if(!(this instanceof e.Pipeline.adapters.Rest))return new e.Pipeline.adapters.Rest(r,a);a=a||{};var i=a.endpoint||r,s={url:a.baseURL?a.baseURL+i:i,contentType:"application/json",dataType:"json"},o=a.recordId||"id",u=a.authenticator||null,c=a.pageConfig,p=a.timeout?1e3*a.timeout:6e4;this.addAuthIdentifier=function(e){return u?u.addAuthIdentifier(e):e},this.deauthorize=function(){u&&u.deauthorize()},this.getAjaxSettings=function(){return s},this.getRecordId=function(){return o},this.getTimeout=function(){return p},this.getPageConfig=function(){return c},this.updatePageConfig=function(e,r){r?(c={},c.metadataLocation=e.metadataLocation?e.metadataLocation:"webLinking",c.previousIdentifier=e.previousIdentifier?e.previousIdentifier:"previous",c.nextIdentifier=e.nextIdentifier?e.nextIdentifier:"next",c.parameterProvider=e.parameterProvider?e.parameterProvider:null):t.extend(c,e)},c&&this.updatePageConfig(c,!0),this.webLinkingPageParser=function(e){var t,r,a,i,s,o={};r=e.getResponseHeader("Link").split(",");for(var u in r){t=r[u].trim().split(";");for(var p in t)a=t[p].trim(),0===a.indexOf("<")&&a.lastIndexOf(">")===t[p].length-1?i=a.substr(1,a.length-2).split("?")[1]:0===a.indexOf("rel=")&&(a.indexOf(c.previousIdentifier)>=0?s=c.previousIdentifier:a.indexOf(c.nextIdentifier)>=0&&(s=c.nextIdentifier));s&&(o[s]=i,s=n)}return o},this.headerPageParser=function(e){var t=e.getResponseHeader(c.previousIdentifier),r=e.getResponseHeader(c.nextIdentifier),n={},a={};return c.parameterProvider?(n=c.parameterProvider(e),a[c.previousIdentifier]=n[c.previousIdentifier],a[c.nextIdentifier]=n[c.nextIdentifier]):(a[c.previousIdentifier]=t?t.split("?")[1]:null,a[c.nextIdentifier]=r?r.split("?")[1]:null),a},this.bodyPageParser=function(e){var t={},r={};return c.parameterProvider?(r=c.parameterProvider(e),t[c.previousIdentifier]=r[c.previousIdentifier],t[c.nextIdentifier]=r[c.nextIdentifier]):(t[c.previousIdentifier]=e[c.previousIdentifier],t[c.nextIdentifier]=e[c.nextIdentifier]),t},this.formatJSONError=function(e){if("json"===this.getAjaxSettings().dataType)try{e.responseJSON=JSON.parse(e.responseText)}catch(t){}return e}},e.Pipeline.adapters.Rest.prototype.read=function(e){var r,a,i,s,o=this,u=this.getRecordId(),c=this.getAjaxSettings(),p=this.getPageConfig();if(e=e?e:{},e.query=e.query?e.query:{},r=e[u]?c.url+"/"+e[u]:c.url,p&&e.paging!==!1){e.paging||(e.paging={offset:e.offsetValue||0,limit:e.limitValue||10}),e.query=e.query||{};for(var f in e.paging)e.query[f]=e.paging[f]}return a=function(t,r,a){var i;p&&e.paging!==!1&&(i=o[p.metadataLocation+"PageParser"]("body"===p.metadataLocation?t:a),["previous","next"].forEach(function(r){t[r]=function(e,t,r){return function(a){return r.paging=!0,r.offsetValue=r.limitValue=n,r.query=t,r.success=a&&a.success?a.success:r.success,r.error=a&&a.error?a.error:r.error,e.read(r)}}(o,i[p[r+"Identifier"]],e)})),e.success&&e.success.apply(this,arguments)},i=function(t){t=o.formatJSONError(t),e.error&&e.error.apply(this,arguments)},s={type:"GET",data:e.query,success:a,error:i,url:r,statusCode:e.statusCode,complete:e.complete,headers:e.headers,timeout:this.getTimeout()},e.jsonp&&(s.dataType="jsonp",s.jsonp=e.jsonp.callback?e.jsonp.callback:"callback",e.jsonp.customCallback&&(s.jsonpCallback=e.jsonp.customCallback)),t.ajax(this.addAuthIdentifier(t.extend({},this.getAjaxSettings(),s)))},e.Pipeline.adapters.Rest.prototype.save=function(e,r){var n,a,i,s,o,u=this,c=this.getRecordId(),p=this.getAjaxSettings();return e=e||{},r=r||{},n=e[c]?"PUT":"POST",a=e[c]?p.url+"/"+e[c]:p.url,i=function(){r.success&&r.success.apply(this,arguments)},s=function(e){e=u.formatJSONError(e),r.error&&r.error.apply(this,arguments)},o=t.extend({},p,{data:e,type:n,url:a,success:i,error:s,statusCode:r.statusCode,complete:r.complete,headers:r.headers,timeout:this.getTimeout()}),"application/json"===o.contentType&&o.data&&"string"!=typeof o.data&&(o.data=JSON.stringify(o.data)),t.ajax(this.addAuthIdentifier(t.extend({},this.getAjaxSettings(),o)))},e.Pipeline.adapters.Rest.prototype.remove=function(e,r){var n,a,i,s,o,u=this,c=this.getRecordId(),p=this.getAjaxSettings(),f="";return"string"==typeof e||"number"==typeof e?n=e:e&&e[c]?n=e[c]:e&&!r&&(r=e),r=r||{},f=n?"/"+n:"",a=p.url+f,i=function(){r.success&&r.success.apply(this,arguments)},s=function(e){e=u.formatJSONError(e),r.error&&r.error.apply(this,arguments)},o={type:"DELETE",url:a,success:i,error:s,statusCode:r.statusCode,complete:r.complete,headers:r.headers,timeout:this.getTimeout()},t.ajax(this.addAuthIdentifier(t.extend({},p,o)))}}(AeroGear,jQuery,uuid),function(e){e.DataManager=function(t){return this instanceof e.DataManager?(e.Core.call(this),this.lib="DataManager",this.type=t?t.type||"Memory":"Memory",this.collectionName="stores",this.add(t),undefined):new e.DataManager(t)},e.DataManager.prototype=e.Core,e.DataManager.constructor=e.DataManager,e.DataManager.adapters={},e.DataManager.STATUS_NEW=1,e.DataManager.STATUS_MODIFIED=2,e.DataManager.STATUS_REMOVED=0}(AeroGear,jQuery),function(e,t){e.DataManager.adapters.Memory=function(t,r){if(!(this instanceof e.DataManager.adapters.Memory))return new e.DataManager.adapters.Memory(t,r);r=r||{};var n=r.recordId?r.recordId:"id",a=null;this.getRecordId=function(){return n},this.getData=function(){return a},this.setData=function(e){a=e},this.emptyData=function(){a=null},this.addDataRecord=function(e){a=a||[],a.push(e)},this.updateDataRecord=function(e,t){a[e]=t},this.removeDataRecord=function(e){a.splice(e,1)},this.traverseObjects=function(e,t,r){for(;"object"==typeof t&&r;)e=Object.keys(t)[0],t=t[e],r=r[e];return t===r?!0:!1}},e.DataManager.adapters.Memory.prototype.read=function(e){var t={};return t[this.getRecordId()]=e,e?this.filter(t):this.getData()},e.DataManager.adapters.Memory.prototype.save=function(t,r){var n=!1;if(t=e.isArray(t)?t:[t],r)this.setData(t);else if(this.getData())for(var a=0;t.length>a;a++){for(var i in this.getData())if(this.getData()[i][this.getRecordId()]===t[a][this.getRecordId()]){this.updateDataRecord(i,t[a]),n=!0;break}n||this.addDataRecord(t[a]),n=!1}else this.setData(t);return this.getData()},e.DataManager.adapters.Memory.prototype.remove=function(t){if(!t)return this.emptyData(),this.getData();t=e.isArray(t)?t:[t];for(var r,n,a,i=0;t.length>i;i++){if("string"==typeof t[i]||"number"==typeof t[i])r=t[i];else{if(!t)continue;r=t[i][this.getRecordId()]}n=this.getData(!0);for(a in n)n[a][this.getRecordId()]===r&&this.removeDataRecord(a)}return this.getData()},e.DataManager.adapters.Memory.prototype.filter=function(r,n){var a,i,s,o,u,c=this;return a=r?this.getData().filter(function(a){var p,f,h=n?!1:!0,d=Object.keys(r);for(i=0;d.length>i;i++){if(r[d[i]].data)for(p=r[d[i]],f=p.matchAny?!1:!0,s=0;p.data.length>s;s++)if(e.isArray(a[d[i]]))if(a[d[i]].length){if(0===t(a[d]).not(p.data).length&&0===t(p.data).not(a[d]).length){f=!0;break}for(o=0;a[d[i]].length>o;o++){if(p.matchAny&&p.data[s]===a[d[i]][o]){if(f=!0,n)break;for(u=0;a[d[i]].length>u;u++)if(!n&&p.data[s]!==a[d[i]][u]){f=!1;break}}if(!p.matchAny&&p.data[s]!==a[d[i]][o]){f=!1;break}}}else f=!1;else if("object"==typeof p.data[s]){if(p.matchAny&&c.traverseObjects(d[i],p.data[s],a[d[i]])){f=!0;break}if(!p.matchAny&&!c.traverseObjects(d[i],p.data[s],a[d[i]])){f=!1;break}}else{if(p.matchAny&&p.data[s]===a[d[i]]){f=!0;break}if(!p.matchAny&&p.data[s]!==a[d[i]]){f=!1;break}}else if(e.isArray(a[d[i]]))if(f=n?!1:!0,a[d[i]].length)for(s=0;a[d[i]].length>s;s++){if(n&&r[d[i]]===a[d[i]][s]){f=!0;break}if(!n&&r[d[i]]!==a[d[i]][s]){f=!1;break}}else f=!1;else f="object"==typeof r[d[i]]?c.traverseObjects(d[i],r[d[i]],a[d[i]]):r[d[i]]===a[d[i]]?!0:!1;if(n&&f){h=!0;break}if(!n&&!f){h=!1;break}}return h}):this.getData()||[]}}(AeroGear,jQuery,uuid),function(e){e.DataManager.adapters.SessionLocal=function(t,r){if(!(this instanceof e.DataManager.adapters.SessionLocal))return new e.DataManager.adapters.SessionLocal(t,r);e.DataManager.adapters.Memory.apply(this,arguments);var n=r.storageType||"sessionStorage",a=t,i=document.location.pathname.replace(/[\/\.]/g,"-"),s=a+i,o=JSON.parse(window[n].getItem(s));o&&e.DataManager.adapters.Memory.prototype.save.call(this,o,!0),this.getStoreType=function(){return n},this.getStoreKey=function(){return s}},e.DataManager.adapters.SessionLocal.prototype=Object.create(new e.DataManager.adapters.Memory,{save:{value:function(t,r){var n=r&&r.reset?r.reset:!1,a=window[this.getStoreType()].getItem(this.getStoreKey()),i=e.DataManager.adapters.Memory.prototype.save.apply(this,[arguments[0],n]);try{window[this.getStoreType()].setItem(this.getStoreKey(),JSON.stringify(i)),r&&r.storageSuccess&&r.storageSuccess(i)}catch(s){if(a=a?JSON.parse(a):[],i=e.DataManager.adapters.Memory.prototype.save.apply(this,[a,!0]),!r||!r.storageError)throw s;r.storageError(s,t)}return i},enumerable:!0,configurable:!0,writable:!0},remove:{value:function(){var t=e.DataManager.adapters.Memory.prototype.remove.apply(this,arguments);return window[this.getStoreType()].setItem(this.getStoreKey(),JSON.stringify(t)),t},enumerable:!0,configurable:!0,writable:!0}})}(AeroGear,jQuery,uuid),function(e){e.Auth=function(t){return this instanceof e.Auth?(e.Core.call(this),this.lib="Auth",this.type=t?t.type||"Rest":"Rest",this.collectionName="modules",this.add(t),undefined):new e.Auth(t)},e.Auth.prototype=e.Core,e.Auth.constructor=e.Auth,e.Auth.adapters={}}(AeroGear,jQuery),function(e,t){e.Auth.adapters.Rest=function(r,n){if(!(this instanceof e.Auth.adapters.Rest))return new e.Auth.adapters.Rest(r,n);n=n||{};var a=n.endpoints||{},i=r,s=!!n.agAuth,o=n.baseURL||"",u=n.tokenName||"Auth-Token";this.isAuthenticated=function(){return s?!!sessionStorage.getItem("ag-auth-"+i):!0},this.addAuthIdentifier=function(e){return e.headers=e.headers?e.headers:{},e.headers[u]=sessionStorage.getItem("ag-auth-"+i),t.extend({},e)},this.deauthorize=function(){sessionStorage.removeItem("ag-auth-"+i)},this.getSettings=function(){return n},this.getEndpoints=function(){return a},this.getName=function(){return i},this.getAGAuth=function(){return s},this.getBaseURL=function(){return o},this.getTokenName=function(){return u},this.processOptions=function(e){var t={};return e.contentType?t.contentType=e.contentType:s&&(t.contentType="application/json"),e.dataType?t.dataType=e.dataType:s&&(t.dataType="json"),t.url=e.baseURL?e.baseURL:o,t}},e.Auth.adapters.Rest.prototype.enroll=function(e,r){r=r||{};var n=this,a=this.getName(),i=this.getTokenName(),s=this.getEndpoints(),o=function(e,t,s){sessionStorage.setItem("ag-auth-"+a,n.getAGAuth()?s.getResponseHeader(i):"true"),r.success&&r.success.apply(this,arguments)},u=function(e,t,n){var a;try{e.responseJSON=JSON.parse(e.responseText),a=[e,t,n]}catch(i){a=arguments}r.error&&r.error.apply(this,a)},c=t.extend({},this.processOptions(r),{success:o,error:u,data:e});return c.url+=s.enroll?s.enroll:"auth/enroll","application/json"===c.contentType&&c.data&&"string"!=typeof c.data&&(c.data=JSON.stringify(c.data)),t.ajax(t.extend({},this.getSettings(),{type:"POST"},c))},e.Auth.adapters.Rest.prototype.login=function(e,r){r=r||{};var n=this,a=this.getName(),i=this.getTokenName(),s=this.getEndpoints(),o=function(e,t,s){sessionStorage.setItem("ag-auth-"+a,n.getAGAuth()?s.getResponseHeader(i):"true"),r.success&&r.success.apply(this,arguments)},u=function(e,t,n){var a;try{e.responseJSON=JSON.parse(e.responseText),a=[e,t,n]}catch(i){a=arguments}r.error&&r.error.apply(this,a)},c=t.extend({},this.processOptions(r),{success:o,error:u,data:e});return c.url+=s.login?s.login:"auth/login","application/json"===c.contentType&&c.data&&"string"!=typeof c.data&&(c.data=JSON.stringify(c.data)),t.ajax(t.extend({},this.getSettings(),{type:"POST"},c))},e.Auth.adapters.Rest.prototype.logout=function(e){e=e||{};var r=this,n=this.getName(),a=this.getTokenName(),i=this.getEndpoints(),s=function(){r.deauthorize(),e.success&&e.success.apply(this,arguments)},o=function(t,r,n){var a;try{t.responseJSON=JSON.parse(t.responseText),a=[t,r,n]}catch(i){a=arguments}e.error&&e.error.apply(this,a)},u=t.extend({},this.processOptions(e),{success:s,error:o});return u.url+=i.logout?i.logout:"auth/logout",u.headers={},u.headers[a]=sessionStorage.getItem("ag-auth-"+n),t.ajax(t.extend({},this.getSettings(),{type:"POST"},u))}}(AeroGear,jQuery),function(e){e.Notifier=function(t){return this instanceof e.Notifier?(e.Core.call(this),this.lib="Notifier",this.type=t?t.type||"vertx":"vertx",this.collectionName="clients",this.add(t),undefined):new e.Notifier(t)},e.Notifier.prototype=e.Core,e.Notifier.constructor=e.Notifier,e.Notifier.adapters={},e.Notifier.CONNECTING=0,e.Notifier.CONNECTED=1,e.Notifier.DISCONNECTING=2,e.Notifier.DISCONNECTED=3}(AeroGear),function(e,t){e.Notifier.adapters.vertx=function(t,r){if(!(this instanceof e.Notifier.adapters.vertx))return new e.Notifier.adapters.vertx(t,r);r=r||{};var n=t,a=r.channels||[],i=!!r.autoConnect||a.length,s=r.connectURL||"",o=e.Notifier.CONNECTING,u=null;this.getSettings=function(){return r},this.getName=function(){return n},this.getAutoConnect=function(){return i},this.getOnConnect=function(){return r.onConnect},this.getOnDisconnect=function(){return r.onDisconnect},this.getOnConnectError=function(){return r.onConnectError},this.getConnectURL=function(){return s},this.setConnectURL=function(e){s=e},this.getChannels=function(){return a},this.addChannel=function(e){a.push(e)},this.removeChannel=function(e){for(var t=0;a.length>t;t++)if(a[t].address===e.address)return a.splice(t,1),undefined},this.removeAllChannels=function(){a=[]},this.getState=function(){return o},this.setState=function(e){o=e},this.getBus=function(){return u},this.setBus=function(e){u=e},(this.getAutoConnect()||this.getChannels().length)&&this.connect({url:this.getConnectURL(),onConnect:this.getOnConnect(),onDisconnect:this.getOnDisconnect(),onConnectError:this.getOnConnectError()})},e.Notifier.adapters.vertx.prototype.connect=function(r){r=r||{};var n=this,a=new t.EventBus(r.url||this.getConnectURL());a.onopen=function(){var t=n.getChannels();n.setState(e.Notifier.CONNECTED),n.subscribe(t,!0),r.onConnect&&r.onConnect.apply(this,arguments)},a.onclose=function(){n.getState()===e.Notifier.DISCONNECTING?(n.setState(e.Notifier.DISCONNECTED),r.onDisconnect&&r.onDisconnect.apply(this,arguments)):r.onConnectError&&r.onConnectError.apply(this,arguments)},this.setBus(a)},e.Notifier.adapters.vertx.prototype.disconnect=function(){var t=this.getBus();this.getState()===e.Notifier.CONNECTED&&(this.setState(e.Notifier.DISCONNECTING),t.close())},e.Notifier.adapters.vertx.prototype.subscribe=function(t,r){var n=this.getBus();r&&this.removeAllChannels(),t=e.isArray(t)?t:[t];for(var a=0;t.length>a;a++)this.addChannel(t[a]),n.registerHandler(t[a].address,t[a].callback)},e.Notifier.adapters.vertx.prototype.unsubscribe=function(t){var r=this.getBus();t=e.isArray(t)?t:[t];for(var n=0;t.length>n;n++)this.removeChannel(t[n]),r.unregisterHandler(t[n].address,t[n].callback)}}(AeroGear,vertx);
//@ sourceMappingURL=dist/aerogear.js.map